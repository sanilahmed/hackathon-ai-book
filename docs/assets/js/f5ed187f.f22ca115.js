"use strict";(globalThis.webpackChunkphysical_ai_book=globalThis.webpackChunkphysical_ai_book||[]).push([[2815],{529:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var i=t(4848),s=t(8453);const r={},o="Lab 2.3: Unity Robotics Integration",a={id:"modules/lab-exercises/lab-2-3-unity-robotics-integration",title:"Lab 2.3: Unity Robotics Integration",description:"Overview",source:"@site/docs/modules/lab-exercises/lab-2-3-unity-robotics-integration.md",sourceDirName:"modules/lab-exercises",slug:"/modules/lab-exercises/lab-2-3-unity-robotics-integration",permalink:"/ai-robotic-book/modules/lab-exercises/lab-2-3-unity-robotics-integration",draft:!1,unlisted:!1,editUrl:"https://github.com/your-org/physical-ai-book/tree/main/docs/modules/lab-exercises/lab-2-3-unity-robotics-integration.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Lab 2.2: Robot Model Creation and Integration",permalink:"/ai-robotic-book/modules/lab-exercises/lab-2-2-robot-model-integration"},next:{title:"Lab 2.4: Multi-Environment Synchronization",permalink:"/ai-robotic-book/modules/lab-exercises/lab-2-4-multi-environment-synchronization"}},l={},c=[{value:"Overview",id:"overview",level:2},{value:"Objectives",id:"objectives",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Duration",id:"duration",level:2},{value:"Exercise 1: Install Unity Robotics Hub",id:"exercise-1-install-unity-robotics-hub",level:2},{value:"Step 1: Download and Install Unity Hub",id:"step-1-download-and-install-unity-hub",level:3},{value:"Step 2: Install Unity 2022.3 LTS",id:"step-2-install-unity-20223-lts",level:3},{value:"Step 3: Install Unity Robotics Hub packages",id:"step-3-install-unity-robotics-hub-packages",level:3},{value:"Step 4: Alternative installation via Git URL",id:"step-4-alternative-installation-via-git-url",level:3},{value:"Exercise 2: Set up ROS-TCP-Connector",id:"exercise-2-set-up-ros-tcp-connector",level:2},{value:"Step 1: Create a new Unity project",id:"step-1-create-a-new-unity-project",level:3},{value:"Step 2: Configure ROS-TCP-Connector",id:"step-2-configure-ros-tcp-connector",level:3},{value:"Step 3: Create a basic ROS connection script",id:"step-3-create-a-basic-ros-connection-script",level:3},{value:"Step 4: Attach the script to Main Camera",id:"step-4-attach-the-script-to-main-camera",level:3},{value:"Exercise 3: Create a Robot Model in Unity",id:"exercise-3-create-a-robot-model-in-unity",level:2},{value:"Step 1: Import the robot model",id:"step-1-import-the-robot-model",level:3},{value:"Step 2: Create a robot hierarchy",id:"step-2-create-a-robot-hierarchy",level:3},{value:"Step 3: Set up the robot hierarchy",id:"step-3-set-up-the-robot-hierarchy",level:3},{value:"Exercise 4: Implement Perception System",id:"exercise-4-implement-perception-system",level:2},{value:"Step 1: Install and configure Perception package",id:"step-1-install-and-configure-perception-package",level:3},{value:"Step 2: Create a perception script",id:"step-2-create-a-perception-script",level:3},{value:"Exercise 5: Create a Complete Unity Robot Scene",id:"exercise-5-create-a-complete-unity-robot-scene",level:2},{value:"Step 1: Set up the scene",id:"step-1-set-up-the-scene",level:3},{value:"Step 2: Create the complete robot",id:"step-2-create-the-complete-robot",level:3},{value:"Step 3: Configure the robot controller",id:"step-3-configure-the-robot-controller",level:3},{value:"Exercise 6: Test Unity-ROS Communication",id:"exercise-6-test-unity-ros-communication",level:2},{value:"Step 1: Set up ROS bridge",id:"step-1-set-up-ros-bridge",level:3},{value:"Step 2: Build and run the test",id:"step-2-build-and-run-the-test",level:3},{value:"Step 3: Configure Unity to connect to ROS",id:"step-3-configure-unity-to-connect-to-ros",level:3},{value:"Exercise 7: Create a Digital Twin Scene",id:"exercise-7-create-a-digital-twin-scene",level:2},{value:"Step 1: Create a synchronized environment",id:"step-1-create-a-synchronized-environment",level:3},{value:"Step 2: Create a synchronized scene",id:"step-2-create-a-synchronized-scene",level:3},{value:"Exercise 8: Implement Synthetic Data Generation",id:"exercise-8-implement-synthetic-data-generation",level:2},{value:"Step 1: Set up Perception package for synthetic data",id:"step-1-set-up-perception-package-for-synthetic-data",level:3},{value:"Step 2: Create synthetic data generation script",id:"step-2-create-synthetic-data-generation-script",level:3},{value:"Exercise 9: Testing and Validation",id:"exercise-9-testing-and-validation",level:2},{value:"Step 1: Create a test scene",id:"step-1-create-a-test-scene",level:3},{value:"Step 2: Verify communication",id:"step-2-verify-communication",level:3},{value:"Step 3: Test with RViz",id:"step-3-test-with-rviz",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues and Solutions",id:"common-issues-and-solutions",level:3},{value:"Assessment Questions",id:"assessment-questions",level:2},{value:"Extension Exercises",id:"extension-exercises",level:2},{value:"Summary",id:"summary",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"lab-23-unity-robotics-integration",children:"Lab 2.3: Unity Robotics Integration"}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"In this lab, you will learn how to integrate Unity with ROS for robotics applications. You'll set up the Unity Robotics Hub, create a robot model in Unity, implement perception systems, and establish communication with ROS. This lab focuses on creating a digital twin environment that mirrors the Gazebo simulation."}),"\n",(0,i.jsx)(n.h2,{id:"objectives",children:"Objectives"}),"\n",(0,i.jsx)(n.p,{children:"By the end of this lab, you will be able to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Install and configure Unity Robotics Hub"}),"\n",(0,i.jsx)(n.li,{children:"Set up ROS-TCP-Connector for Unity-ROS communication"}),"\n",(0,i.jsx)(n.li,{children:"Create robot models and scenes in Unity for robotics"}),"\n",(0,i.jsx)(n.li,{children:"Implement perception systems using Unity's Perception package"}),"\n",(0,i.jsx)(n.li,{children:"Establish bidirectional communication between Unity and ROS"}),"\n",(0,i.jsx)(n.li,{children:"Create synthetic data generation pipelines for computer vision"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Unity 2022.3 LTS installed"}),"\n",(0,i.jsx)(n.li,{children:"Basic Unity development knowledge"}),"\n",(0,i.jsx)(n.li,{children:"Completion of Module 1 (ROS 2 basics)"}),"\n",(0,i.jsx)(n.li,{children:"Completion of Lab 2.1 and 2.2 (Gazebo and robot modeling)"}),"\n",(0,i.jsx)(n.li,{children:"ROS 2 Humble Hawksbill installed"}),"\n",(0,i.jsx)(n.li,{children:"Ubuntu 20.04 or 22.04 LTS"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"duration",children:"Duration"}),"\n",(0,i.jsx)(n.p,{children:"4-5 hours"}),"\n",(0,i.jsx)(n.h2,{id:"exercise-1-install-unity-robotics-hub",children:"Exercise 1: Install Unity Robotics Hub"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-download-and-install-unity-hub",children:"Step 1: Download and Install Unity Hub"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Go to ",(0,i.jsx)(n.a,{href:"https://unity.com/download",children:"https://unity.com/download"})," and download Unity Hub"]}),"\n",(0,i.jsx)(n.li,{children:"Install Unity Hub following the Ubuntu installation instructions"}),"\n",(0,i.jsx)(n.li,{children:"Launch Unity Hub and sign in with your Unity ID"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-2-install-unity-20223-lts",children:"Step 2: Install Unity 2022.3 LTS"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:'In Unity Hub, go to the "Installs" tab'}),"\n",(0,i.jsx)(n.li,{children:'Click "Add" and select Unity 2022.3.x LTS version'}),"\n",(0,i.jsx)(n.li,{children:"Select the modules: Linux Build Support, Visual Scripting (optional)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-3-install-unity-robotics-hub-packages",children:"Step 3: Install Unity Robotics Hub packages"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a new 3D project in Unity Hub"}),"\n",(0,i.jsx)(n.li,{children:"In Unity, go to Window \u2192 Package Manager"}),"\n",(0,i.jsxs)(n.li,{children:["Install the following packages:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"ROS-TCP-Connector"}),"\n",(0,i.jsx)(n.li,{children:"Perception package"}),"\n",(0,i.jsx)(n.li,{children:"Robotics Simulation Library (if available)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-4-alternative-installation-via-git-url",children:"Step 4: Alternative installation via Git URL"}),"\n",(0,i.jsx)(n.p,{children:"If packages aren't available in Package Manager:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:'In Package Manager, click the "+" button \u2192 "Add package from git URL..."'}),"\n",(0,i.jsxs)(n.li,{children:["Add these repositories:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"https://github.com/Unity-Technologies/ROS-TCP-Connector.git?path=/com.unity.robotics.ros-tcp-connector"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"https://github.com/Unity-Technologies/com.unity.perception.git"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"exercise-2-set-up-ros-tcp-connector",children:"Exercise 2: Set up ROS-TCP-Connector"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-create-a-new-unity-project",children:"Step 1: Create a new Unity project"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Open Unity Hub"}),"\n",(0,i.jsx)(n.li,{children:'Create a new 3D Core project named "RoboticsSimulation"'}),"\n",(0,i.jsx)(n.li,{children:"Open the project in Unity"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-2-configure-ros-tcp-connector",children:"Step 2: Configure ROS-TCP-Connector"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"In Unity, go to GameObject \u2192 Unity Robotics \u2192 ROS Settings"}),"\n",(0,i.jsxs)(n.li,{children:["In the Inspector, set the ROS Connection settings:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["ROS IP: ",(0,i.jsx)(n.code,{children:"127.0.0.1"})," (localhost)"]}),"\n",(0,i.jsxs)(n.li,{children:["ROS Port: ",(0,i.jsx)(n.code,{children:"10000"})]}),"\n",(0,i.jsx)(n.li,{children:"Use SSL: false"}),"\n",(0,i.jsx)(n.li,{children:"Reconnection Delay: 1000 ms"}),"\n",(0,i.jsx)(n.li,{children:"Max Reconnection Attempts: 10"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-3-create-a-basic-ros-connection-script",children:"Step 3: Create a basic ROS connection script"}),"\n",(0,i.jsxs)(n.p,{children:["Create a C# script ",(0,i.jsx)(n.code,{children:"Assets/Scripts/ROSConnectionManager.cs"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using System.Collections;\nusing UnityEngine;\nusing Unity.Robotics.ROSTCPConnector;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Std_msgs;\n\npublic class ROSConnectionManager : MonoBehaviour\n{\n    ROSConnection ros;\n    string rosTopic = "unity_message";\n\n    // Start is called before the first frame update\n    void Start()\n    {\n        // Get the ROS connection static instance\n        ros = ROSConnection.instance;\n\n        // Subscribe to a topic\n        ros.Subscribe<StringMsg>(rosTopic, OnMessageReceived);\n\n        // Start sending messages\n        StartCoroutine(SendMessage());\n    }\n\n    // Callback invoked when a message is received from ROS\n    void OnMessageReceived(StringMsg msg)\n    {\n        Debug.Log("Received from ROS: " + msg.data);\n    }\n\n    // Send a message to ROS\n    IEnumerator SendMessage()\n    {\n        while (true)\n        {\n            // Create a new message\n            StringMsg msg = new StringMsg();\n            msg.data = "Hello from Unity! Time: " + Time.time;\n\n            // Send the message\n            ros.Publish(rosTopic, msg);\n\n            // Wait 1 second\n            yield return new WaitForSeconds(1.0f);\n        }\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-4-attach-the-script-to-main-camera",children:"Step 4: Attach the script to Main Camera"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"In the Hierarchy, select the Main Camera"}),"\n",(0,i.jsx)(n.li,{children:'In the Inspector, click "Add Component"'}),"\n",(0,i.jsx)(n.li,{children:'Search for and add the "ROSConnectionManager" script'}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"exercise-3-create-a-robot-model-in-unity",children:"Exercise 3: Create a Robot Model in Unity"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-import-the-robot-model",children:"Step 1: Import the robot model"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["In Unity, create a new folder: ",(0,i.jsx)(n.code,{children:"Assets/Models/Robot"})]}),"\n",(0,i.jsxs)(n.li,{children:["Create a simple robot using primitives:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Create a cube for the body"}),"\n",(0,i.jsx)(n.li,{children:"Create spheres for the head"}),"\n",(0,i.jsx)(n.li,{children:"Create cylinders for arms and legs"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-2-create-a-robot-hierarchy",children:"Step 2: Create a robot hierarchy"}),"\n",(0,i.jsxs)(n.p,{children:["Create a C# script ",(0,i.jsx)(n.code,{children:"Assets/Scripts/RobotController.cs"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\nusing Unity.Robotics.ROSTCPConnector;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Geometry_msgs;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Sensor_msgs;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Std_msgs;\n\npublic class RobotController : MonoBehaviour\n{\n    ROSConnection ros;\n    string cmdVelTopic = "cmd_vel";\n    string jointStatesTopic = "joint_states";\n\n    // Robot components\n    public Transform body;\n    public Transform leftArm;\n    public Transform rightArm;\n    public Transform leftLeg;\n    public Transform rightLeg;\n\n    // Joint angles\n    float leftArmAngle = 0f;\n    float rightArmAngle = 0f;\n    float leftLegAngle = 0f;\n    float rightLegAngle = 0f;\n\n    // Start is called before the first frame update\n    void Start()\n    {\n        ros = ROSConnection.instance;\n\n        // Subscribe to command velocity topic\n        ros.Subscribe<TwistMsg>(cmdVelTopic, OnCmdVelReceived);\n    }\n\n    // Callback for velocity commands\n    void OnCmdVelReceived(TwistMsg cmd)\n    {\n        // Move the robot based on linear and angular velocity\n        transform.Translate(new Vector3((float)cmd.linear.x, 0, (float)cmd.linear.y) * Time.deltaTime);\n        transform.Rotate(0, (float)cmd.angular.z * Time.deltaTime * 50f, 0);\n    }\n\n    // Update is called once per frame\n    void Update()\n    {\n        // Animate joints (for demonstration)\n        AnimateJoints();\n\n        // Publish joint states periodically\n        if (Time.frameCount % 60 == 0) // Every second at 60 FPS\n        {\n            PublishJointStates();\n        }\n    }\n\n    void AnimateJoints()\n    {\n        // Simple joint animation\n        leftArmAngle = Mathf.Sin(Time.time) * 30f;\n        rightArmAngle = Mathf.Cos(Time.time) * 30f;\n        leftLegAngle = Mathf.Sin(Time.time * 0.5f) * 15f;\n        rightLegAngle = Mathf.Cos(Time.time * 0.5f) * 15f;\n\n        // Apply rotations\n        if (leftArm != null)\n            leftArm.localRotation = Quaternion.Euler(leftArmAngle, 0, 0);\n        if (rightArm != null)\n            rightArm.localRotation = Quaternion.Euler(rightArmAngle, 0, 0);\n        if (leftLeg != null)\n            leftLeg.localRotation = Quaternion.Euler(leftLegAngle, 0, 0);\n        if (rightLeg != null)\n            rightLeg.localRotation = Quaternion.Euler(rightLegAngle, 0, 0);\n    }\n\n    void PublishJointStates()\n    {\n        // Create joint state message\n        JointStateMsg jointState = new JointStateMsg();\n        jointState.name = new string[] { "left_arm_joint", "right_arm_joint", "left_leg_joint", "right_leg_joint" };\n        jointState.position = new double[] {\n            leftArmAngle * Mathf.Deg2Rad,\n            rightArmAngle * Mathf.Deg2Rad,\n            leftLegAngle * Mathf.Deg2Rad,\n            rightLegAngle * Mathf.Deg2Rad\n        };\n        jointState.velocity = new double[] { 0, 0, 0, 0 };\n        jointState.effort = new double[] { 0, 0, 0, 0 };\n        jointState.header.stamp = new TimeStamp(Time.time);\n        jointState.header.frame_id = "base_link";\n\n        ros.Publish(jointStatesTopic, jointState);\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-3-set-up-the-robot-hierarchy",children:"Step 3: Set up the robot hierarchy"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:'Create an empty GameObject named "Robot"'}),"\n",(0,i.jsx)(n.li,{children:"Add the RobotController script to it"}),"\n",(0,i.jsx)(n.li,{children:"Create child objects for body, head, arms, and legs"}),"\n",(0,i.jsx)(n.li,{children:"Assign the transforms in the RobotController script"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"exercise-4-implement-perception-system",children:"Exercise 4: Implement Perception System"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-install-and-configure-perception-package",children:"Step 1: Install and configure Perception package"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"In Package Manager, install the Perception package"}),"\n",(0,i.jsxs)(n.li,{children:["Create a new Perception Camera:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"GameObject \u2192 Perception \u2192 Perception Camera"}),"\n",(0,i.jsx)(n.li,{children:"Position it appropriately on your robot"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-2-create-a-perception-script",children:"Step 2: Create a perception script"}),"\n",(0,i.jsxs)(n.p,{children:["Create ",(0,i.jsx)(n.code,{children:"Assets/Scripts/PerceptionManager.cs"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\nusing UnityEngine.Perception.GroundTruth;\nusing Unity.Robotics.ROSTCPConnector;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Sensor_msgs;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Std_msgs;\nusing System.Linq;\n\npublic class PerceptionManager : MonoBehaviour\n{\n    ROSConnection ros;\n    string cameraInfoTopic = "camera_info";\n    string imageTopic = "image_raw";\n\n    public Camera perceptionCamera;\n    public int imageWidth = 640;\n    public int imageHeight = 480;\n\n    RenderTexture renderTexture;\n    PerceptionCamera perceptionCamComponent;\n\n    void Start()\n    {\n        ros = ROSConnection.instance;\n\n        // Set up render texture for camera\n        renderTexture = new RenderTexture(imageWidth, imageHeight, 24);\n        perceptionCamera.targetTexture = renderTexture;\n\n        // Add perception camera component if not already present\n        perceptionCamComponent = perceptionCamera.GetComponent<PerceptionCamera>();\n        if (perceptionCamComponent == null)\n        {\n            perceptionCamComponent = perceptionCamera.gameObject.AddComponent<PerceptionCamera>();\n        }\n\n        // Configure perception camera\n        perceptionCamComponent.captureRgbImages = true;\n        perceptionCamComponent.rgbImageCaptureSettings.frequency = CaptureFrequency.Variable;\n        perceptionCamComponent.rgbImageCaptureSettings.targetFrameRate = 30;\n    }\n\n    void Update()\n    {\n        // Capture and publish image periodically\n        if (Time.frameCount % 2 == 0) // Every other frame at 60 FPS = 30 FPS\n        {\n            PublishCameraImage();\n        }\n    }\n\n    void PublishCameraImage()\n    {\n        // Create texture to read from\n        Texture2D texture = new Texture2D(imageWidth, imageHeight, TextureFormat.RGB24, false);\n\n        // Set the active render texture\n        RenderTexture.active = renderTexture;\n\n        // Copy the pixels from the render texture to the texture\n        texture.ReadPixels(new Rect(0, 0, imageWidth, imageHeight), 0, 0);\n        texture.Apply();\n\n        // Convert to byte array (this is a simplified approach)\n        byte[] imageBytes = texture.EncodeToJPG();\n\n        // Create ROS image message (simplified - in practice, you\'d use proper encoding)\n        // For this example, we\'ll just publish a placeholder\n        StringMsg imageMsg = new StringMsg();\n        imageMsg.data = "Image data would go here";\n\n        ros.Publish(imageTopic, imageMsg);\n\n        // Clean up\n        Destroy(texture);\n    }\n\n    void OnDestroy()\n    {\n        if (renderTexture != null)\n            Destroy(renderTexture);\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"exercise-5-create-a-complete-unity-robot-scene",children:"Exercise 5: Create a Complete Unity Robot Scene"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-set-up-the-scene",children:"Step 1: Set up the scene"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a new scene: File \u2192 New Scene"}),"\n",(0,i.jsx)(n.li,{children:'Save it as "RobotScene" in Assets/Scenes/'}),"\n",(0,i.jsx)(n.li,{children:"Add lighting: GameObject \u2192 Light \u2192 Directional Light"}),"\n",(0,i.jsx)(n.li,{children:"Add ground plane: GameObject \u2192 3D Object \u2192 Plane"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-2-create-the-complete-robot",children:"Step 2: Create the complete robot"}),"\n",(0,i.jsx)(n.p,{children:"Create a more detailed robot with proper joint setup:"}),"\n",(0,i.jsxs)(n.p,{children:["Create ",(0,i.jsx)(n.code,{children:"Assets/Scripts/DetailedRobotController.cs"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using System.Collections;\nusing UnityEngine;\nusing Unity.Robotics.ROSTCPConnector;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Geometry_msgs;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Sensor_msgs;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Std_msgs;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Nav_msgs;\n\npublic class DetailedRobotController : MonoBehaviour\n{\n    ROSConnection ros;\n\n    // ROS topics\n    string cmdVelTopic = "/cmd_vel";\n    string jointStatesTopic = "/joint_states";\n    string odomTopic = "/odom";\n    string imuTopic = "/imu";\n    string laserScanTopic = "/scan";\n\n    // Robot configuration\n    public Transform baseLink;\n    public Transform[] joints; // Array of joint transforms\n    public string[] jointNames; // Corresponding joint names\n\n    // Robot state\n    Vector3 position;\n    Quaternion rotation;\n    Vector3 velocity;\n    Vector3 angularVelocity;\n\n    // IMU simulation\n    float imuRoll, imuPitch, imuYaw;\n\n    void Start()\n    {\n        ros = ROSConnection.instance;\n\n        // Initialize robot state\n        position = transform.position;\n        rotation = transform.rotation;\n\n        // Subscribe to command topics\n        ros.Subscribe<TwistMsg>(cmdVelTopic, OnCmdVelReceived);\n\n        // Start publishing sensor data\n        StartCoroutine(PublishSensorData());\n    }\n\n    void OnCmdVelReceived(TwistMsg cmd)\n    {\n        // Apply velocity commands to robot\n        Vector3 linear = new Vector3((float)cmd.linear.x, 0, (float)cmd.linear.y);\n        float angular = (float)cmd.angular.z;\n\n        // Convert to world space and apply\n        position += transform.TransformDirection(linear) * Time.deltaTime;\n        transform.position = position;\n\n        // Apply angular rotation\n        transform.Rotate(0, angular * Time.deltaTime * Mathf.Rad2Deg, 0);\n\n        // Update state\n        velocity = linear;\n        angularVelocity = new Vector3(0, angular, 0);\n    }\n\n    IEnumerator PublishSensorData()\n    {\n        while (true)\n        {\n            // Publish joint states\n            PublishJointStates();\n\n            // Publish odometry\n            PublishOdometry();\n\n            // Publish IMU data\n            PublishIMUData();\n\n            // Publish laser scan (simulated)\n            PublishLaserScan();\n\n            yield return new WaitForSeconds(0.1f); // 10 Hz\n        }\n    }\n\n    void PublishJointStates()\n    {\n        JointStateMsg jointState = new JointStateMsg();\n        jointState.name = jointNames;\n        jointState.position = new double[joints.Length];\n        jointState.velocity = new double[joints.Length];\n        jointState.effort = new double[joints.Length];\n\n        for (int i = 0; i < joints.Length; i++)\n        {\n            if (joints[i] != null)\n            {\n                // Get joint angle (simplified - you\'d need to extract the relevant rotation)\n                jointState.position[i] = joints[i].localEulerAngles.y * Mathf.Deg2Rad; // Example\n            }\n        }\n\n        jointState.header.stamp = new TimeStamp(Time.time);\n        jointState.header.frame_id = "base_link";\n\n        ros.Publish(jointStatesTopic, jointState);\n    }\n\n    void PublishOdometry()\n    {\n        OdometryMsg odom = new OdometryMsg();\n\n        odom.header.stamp = new TimeStamp(Time.time);\n        odom.header.frame_id = "odom";\n        odom.child_frame_id = "base_link";\n\n        // Position\n        odom.pose.pose.position.x = transform.position.x;\n        odom.pose.pose.position.y = transform.position.z; // Unity Z -> ROS Y\n        odom.pose.pose.position.z = transform.position.y; // Unity Y -> ROS Z\n\n        // Orientation (convert Unity to ROS coordinate system)\n        Quaternion unityRot = transform.rotation;\n        odom.pose.pose.orientation.x = unityRot.x;\n        odom.pose.pose.orientation.y = unityRot.z; // Swap Y and Z\n        odom.pose.pose.orientation.z = unityRot.y;\n        odom.pose.pose.orientation.w = unityRot.w;\n\n        // Velocity\n        odom.twist.twist.linear.x = velocity.x;\n        odom.twist.twist.linear.y = velocity.z;\n        odom.twist.twist.linear.z = velocity.y;\n\n        odom.twist.twist.angular.x = angularVelocity.x;\n        odom.twist.twist.angular.y = angularVelocity.z;\n        odom.twist.twist.angular.z = angularVelocity.y;\n\n        ros.Publish(odomTopic, odom);\n    }\n\n    void PublishIMUData()\n    {\n        ImuMsg imu = new ImuMsg();\n\n        imu.header.stamp = new TimeStamp(Time.time);\n        imu.header.frame_id = "imu_link";\n\n        // Simulate IMU data\n        imu.orientation.x = transform.rotation.x;\n        imu.orientation.y = transform.rotation.z;\n        imu.orientation.z = transform.rotation.y;\n        imu.orientation.w = transform.rotation.w;\n\n        // Angular velocity (simplified)\n        imu.angular_velocity.x = angularVelocity.x;\n        imu.angular_velocity.y = angularVelocity.z;\n        imu.angular_velocity.z = angularVelocity.y;\n\n        // Linear acceleration (include gravity)\n        imu.linear_acceleration.x = Physics.gravity.x;\n        imu.linear_acceleration.y = Physics.gravity.z;\n        imu.linear_acceleration.z = Physics.gravity.y;\n\n        ros.Publish(imuTopic, imu);\n    }\n\n    void PublishLaserScan()\n    {\n        LaserScanMsg scan = new LaserScanMsg();\n\n        scan.header.stamp = new TimeStamp(Time.time);\n        scan.header.frame_id = "laser_link";\n\n        // Laser scan parameters\n        scan.angle_min = -Mathf.PI / 2; // -90 degrees\n        scan.angle_max = Mathf.PI / 2;  // 90 degrees\n        scan.angle_increment = Mathf.PI / 180; // 1 degree\n        scan.time_increment = 0.0;\n        scan.scan_time = 0.1f;\n        scan.range_min = 0.1f;\n        scan.range_max = 10.0f;\n\n        // Simulate ranges (simplified)\n        int numReadings = Mathf.RoundToInt((scan.angle_max - scan.angle_min) / scan.angle_increment) + 1;\n        scan.ranges = new float[numReadings];\n\n        for (int i = 0; i < numReadings; i++)\n        {\n            // Simulate distance readings (in a real implementation, you\'d use raycasting)\n            scan.ranges[i] = Random.Range(1.0f, 5.0f); // Random distances for simulation\n        }\n\n        ros.Publish(laserScanTopic, scan);\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-3-configure-the-robot-controller",children:"Step 3: Configure the robot controller"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Add the DetailedRobotController script to your robot root object"}),"\n",(0,i.jsx)(n.li,{children:"Assign the base link and joint transforms in the Inspector"}),"\n",(0,i.jsx)(n.li,{children:"Set up joint names array in the Inspector"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"exercise-6-test-unity-ros-communication",children:"Exercise 6: Test Unity-ROS Communication"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-set-up-ros-bridge",children:"Step 1: Set up ROS bridge"}),"\n",(0,i.jsx)(n.p,{children:"First, let's create a simple ROS node to test communication:"}),"\n",(0,i.jsx)(n.p,{children:"Create a ROS 2 package for testing:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws/src\nros2 pkg create --build-type ament_python unity_test_py --dependencies rclpy geometry_msgs sensor_msgs\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Create ",(0,i.jsx)(n.code,{children:"~/ros2_ws/src/unity_test_py/unity_test_py/test_subscriber.py"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import Twist\nfrom sensor_msgs.msg import JointState, Imu, LaserScan\nfrom nav_msgs.msg import Odometry\n\n\nclass UnityTestSubscriber(Node):\n    def __init__(self):\n        super().__init__('unity_test_subscriber')\n\n        # Create subscribers\n        self.cmd_vel_sub = self.create_subscription(\n            Twist,\n            '/cmd_vel',\n            self.cmd_vel_callback,\n            10\n        )\n\n        self.joint_state_sub = self.create_subscription(\n            JointState,\n            '/joint_states',\n            self.joint_state_callback,\n            10\n        )\n\n        self.odom_sub = self.create_subscription(\n            Odometry,\n            '/odom',\n            self.odom_callback,\n            10\n        )\n\n        self.imu_sub = self.create_subscription(\n            Imu,\n            '/imu',\n            self.imu_callback,\n            10\n        )\n\n        self.scan_sub = self.create_subscription(\n            LaserScan,\n            '/scan',\n            self.scan_callback,\n            10\n        )\n\n        self.get_logger().info('Unity test subscriber started')\n\n    def cmd_vel_callback(self, msg):\n        self.get_logger().info(f'Command velocity received: linear=({msg.linear.x}, {msg.linear.y}, {msg.linear.z}), angular=({msg.angular.x}, {msg.angular.y}, {msg.angular.z})')\n\n    def joint_state_callback(self, msg):\n        self.get_logger().info(f'Joint states received: {len(msg.name)} joints')\n\n    def odom_callback(self, msg):\n        self.get_logger().info(f'Odometry received: pos=({msg.pose.pose.position.x:.2f}, {msg.pose.pose.position.y:.2f}, {msg.pose.pose.position.z:.2f})')\n\n    def imu_callback(self, msg):\n        self.get_logger().info(f'IMU data received')\n\n    def scan_callback(self, msg):\n        self.get_logger().info(f'Laser scan received: {len(msg.ranges)} readings')\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    subscriber = UnityTestSubscriber()\n\n    try:\n        rclpy.spin(subscriber)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        subscriber.destroy_node()\n        rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.p,{children:"Update the setup.py:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from setuptools import setup\nimport os\nfrom glob import glob\n\npackage_name = 'unity_test_py'\n\nsetup(\n    name=package_name,\n    version='0.0.0',\n    packages=[package_name],\n    data_files=[\n        ('share/ament_index/resource_index/packages',\n            ['resource/' + package_name]),\n        ('share/' + package_name, ['package.xml']),\n    ],\n    install_requires=['setuptools'],\n    zip_safe=True,\n    maintainer='Your Name',\n    maintainer_email='your.email@example.com',\n    description='Unity-ROS test package',\n    license='Apache License 2.0',\n    tests_require=['pytest'],\n    entry_points={\n        'console_scripts': [\n            'test_subscriber = unity_test_py.test_subscriber:main',\n        ],\n    },\n)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-2-build-and-run-the-test",children:"Step 2: Build and run the test"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\ncolcon build --packages-select unity_test_py\nsource ~/ros2_ws/install/setup.bash\nros2 run unity_test_py test_subscriber\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-3-configure-unity-to-connect-to-ros",children:"Step 3: Configure Unity to connect to ROS"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"In Unity, make sure your ROS settings point to the correct IP and port"}),"\n",(0,i.jsx)(n.li,{children:"If running ROS on the same machine: IP = 127.0.0.1, Port = 10000"}),"\n",(0,i.jsx)(n.li,{children:"If running ROS on a different machine, use the appropriate IP address"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"exercise-7-create-a-digital-twin-scene",children:"Exercise 7: Create a Digital Twin Scene"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-create-a-synchronized-environment",children:"Step 1: Create a synchronized environment"}),"\n",(0,i.jsxs)(n.p,{children:["Create ",(0,i.jsx)(n.code,{children:"Assets/Scripts/DigitalTwinManager.cs"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\nusing Unity.Robotics.ROSTCPConnector;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Std_msgs;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Tf2_msgs;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Geometry_msgs;\n\npublic class DigitalTwinManager : MonoBehaviour\n{\n    ROSConnection ros;\n\n    // TF topics\n    string tfTopic = "/tf";\n    string tfStaticTopic = "/tf_static";\n\n    // Robot synchronization\n    public GameObject robotPrefab;\n    Dictionary<string, GameObject> robotInstances = new Dictionary<string, GameObject>();\n\n    void Start()\n    {\n        ros = ROSConnection.instance;\n\n        // Subscribe to TF topics to synchronize transforms\n        ros.Subscribe<TFMessage>(tfTopic, OnTFReceived);\n    }\n\n    void OnTFReceived(TFMessage tfMsg)\n    {\n        foreach (var transform in tfMsg.transforms)\n        {\n            string frameId = transform.child_frame_id;\n\n            // Find or create robot instance for this frame\n            if (!robotInstances.ContainsKey(frameId))\n            {\n                GameObject robotObj = Instantiate(robotPrefab);\n                robotObj.name = frameId;\n                robotInstances[frameId] = robotObj;\n            }\n\n            // Update the robot\'s position and rotation\n            GameObject robot = robotInstances[frameId];\n            if (robot != null)\n            {\n                // Convert ROS transform to Unity coordinates\n                Vector3 position = new Vector3(\n                    (float)transform.transform.translation.x,\n                    (float)transform.transform.translation.z, // ROS Z -> Unity Y\n                    (float)transform.transform.translation.y  // ROS Y -> Unity Z\n                );\n\n                Quaternion rotation = new Quaternion(\n                    (float)transform.transform.rotation.x,\n                    (float)transform.transform.rotation.z, // ROS Z -> Unity Y\n                    (float)transform.transform.rotation.y, // ROS Y -> Unity Z\n                    (float)transform.transform.rotation.w\n                );\n\n                robot.transform.position = position;\n                robot.transform.rotation = rotation;\n            }\n        }\n    }\n\n    // Method to publish Unity transforms to ROS (for synchronization)\n    public void PublishTransformToROS(string frameId, string parentFrameId, Transform unityTransform)\n    {\n        TFMessage tfMsg = new TFMessage();\n\n        Geometry_msgs.TransformStamped transformStamped = new Geometry_msgs.TransformStamped();\n        transformStamped.header.stamp = new TimeStamp(Time.time);\n        transformStamped.header.frame_id = parentFrameId;\n        transformStamped.child_frame_id = frameId;\n\n        // Convert Unity transform to ROS coordinates\n        transformStamped.transform.translation.x = unityTransform.position.x;\n        transformStamped.transform.translation.y = unityTransform.position.z; // Unity Z -> ROS Y\n        transformStamped.transform.translation.z = unityTransform.position.y; // Unity Y -> ROS Z\n\n        transformStamped.transform.rotation.x = unityTransform.rotation.x;\n        transformStamped.transform.rotation.y = unityTransform.rotation.z; // Unity Z -> ROS Y\n        transformStamped.transform.rotation.z = unityTransform.rotation.y; // Unity Y -> ROS Z\n        transformStamped.transform.rotation.w = unityTransform.rotation.w;\n\n        tfMsg.transforms = new Geometry_msgs.TransformStamped[] { transformStamped };\n\n        ros.Publish(tfTopic, tfMsg);\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-2-create-a-synchronized-scene",children:"Step 2: Create a synchronized scene"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:'Create a new scene: "DigitalTwinScene"'}),"\n",(0,i.jsx)(n.li,{children:"Add the DigitalTwinManager script to an empty GameObject"}),"\n",(0,i.jsx)(n.li,{children:"Set up the scene to mirror your Gazebo environment"}),"\n",(0,i.jsx)(n.li,{children:"Add synchronized objects that update based on ROS TF data"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"exercise-8-implement-synthetic-data-generation",children:"Exercise 8: Implement Synthetic Data Generation"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-set-up-perception-package-for-synthetic-data",children:"Step 1: Set up Perception package for synthetic data"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"In Unity, go to Window \u2192 Unity Perception \u2192 Perception Camera Manager"}),"\n",(0,i.jsx)(n.li,{children:"Add a Perception Camera to your scene"}),"\n",(0,i.jsx)(n.li,{children:"Configure it for synthetic data generation"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-2-create-synthetic-data-generation-script",children:"Step 2: Create synthetic data generation script"}),"\n",(0,i.jsxs)(n.p,{children:["Create ",(0,i.jsx)(n.code,{children:"Assets/Scripts/SyntheticDataGenerator.cs"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\nusing UnityEngine.Perception.GroundTruth;\nusing Unity.Robotics.ROSTCPConnector;\n\npublic class SyntheticDataGenerator : MonoBehaviour\n{\n    public PerceptionCamera perceptionCamera;\n    public int captureFrequency = 10; // Hz\n    public int imageWidth = 640;\n    public int imageHeight = 480;\n\n    private RenderTexture m_RenderTexture;\n    private int m_FrameCounter = 0;\n    private float m_LastCaptureTime = 0f;\n\n    void Start()\n    {\n        // Create render texture for synthetic data\n        m_RenderTexture = new RenderTexture(imageWidth, imageHeight, 24);\n        perceptionCamera.GetComponent<Camera>().targetTexture = m_RenderTexture;\n\n        // Configure perception camera\n        var perceptionCam = perceptionCamera.GetComponent<PerceptionCamera>();\n        perceptionCam.rgbImageCaptureSettings.frequency = CaptureFrequency.Variable;\n        perceptionCam.rgbImageCaptureSettings.targetFrameRate = captureFrequency;\n\n        // Add semantic segmentation if needed\n        var labeler = perceptionCamera.gameObject.AddComponent<SegmentationLabeler>();\n    }\n\n    void Update()\n    {\n        // Additional synthetic data processing can go here\n        float timeInterval = 1f / captureFrequency;\n\n        if (Time.time - m_LastCaptureTime >= timeInterval)\n        {\n            m_LastCaptureTime = Time.time;\n\n            // Process synthetic data capture\n            ProcessSyntheticDataCapture();\n        }\n    }\n\n    void ProcessSyntheticDataCapture()\n    {\n        // This is where you would process and potentially send\n        // synthetic data to ROS or save it locally\n        Debug.Log($"Synthetic data captured at frame {m_FrameCounter}");\n        m_FrameCounter++;\n    }\n\n    void OnDestroy()\n    {\n        if (m_RenderTexture != null)\n            Destroy(m_RenderTexture);\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"exercise-9-testing-and-validation",children:"Exercise 9: Testing and Validation"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-create-a-test-scene",children:"Step 1: Create a test scene"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a new scene with a simple environment"}),"\n",(0,i.jsx)(n.li,{children:"Add your robot model"}),"\n",(0,i.jsx)(n.li,{children:"Include the ROS connection and perception components"}),"\n",(0,i.jsx)(n.li,{children:"Test the basic functionality"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-2-verify-communication",children:"Step 2: Verify communication"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Run Unity with the robot scene"}),"\n",(0,i.jsx)(n.li,{children:"Start ROS nodes that publish to the topics your Unity scene subscribes to"}),"\n",(0,i.jsx)(n.li,{children:"Verify that Unity receives and responds to commands"}),"\n",(0,i.jsx)(n.li,{children:"Check that Unity publishes sensor data that ROS nodes can receive"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-3-test-with-rviz",children:"Step 3: Test with RViz"}),"\n",(0,i.jsx)(n.p,{children:"Create a ROS launch file to visualize the Unity data:"}),"\n",(0,i.jsxs)(n.p,{children:["Create ",(0,i.jsx)(n.code,{children:"~/ros2_ws/src/unity_test_py/unity_test_py/launch/unity_visualization.launch.py"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import os\nfrom launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument\nfrom launch.substitutions import LaunchConfiguration\nfrom launch_ros.actions import Node\nfrom ament_index_python.packages import get_package_share_directory\n\n\ndef generate_launch_description():\n    # RViz node\n    rviz = Node(\n        package='rviz2',\n        executable='rviz2',\n        name='rviz2',\n        arguments=['-d', os.path.join(get_package_share_directory('unity_test_py'), 'config', 'unity.rviz')],\n        output='screen'\n    )\n\n    # Robot state publisher (for TF visualization)\n    robot_state_publisher = Node(\n        package='robot_state_publisher',\n        executable='robot_state_publisher',\n        name='robot_state_publisher',\n        parameters=[{'use_sim_time': True}]\n    )\n\n    return LaunchDescription([\n        rviz,\n        robot_state_publisher\n    ])\n"})}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(n.h3,{id:"common-issues-and-solutions",children:"Common Issues and Solutions"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Connection issues between Unity and ROS"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Verify IP address and port settings"}),"\n",(0,i.jsx)(n.li,{children:"Check firewall settings"}),"\n",(0,i.jsx)(n.li,{children:"Ensure ROS bridge is running"}),"\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.code,{children:"telnet <ip> <port>"})," to test connectivity"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Coordinate system mismatches"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Unity uses left-handed coordinate system, ROS uses right-handed"}),"\n",(0,i.jsx)(n.li,{children:"Convert between coordinate systems when publishing/subscribing"}),"\n",(0,i.jsx)(n.li,{children:"Pay attention to axis mappings (Y/Z swaps)"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Performance issues"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Reduce rendering quality for real-time performance"}),"\n",(0,i.jsx)(n.li,{children:"Limit the frequency of data publishing"}),"\n",(0,i.jsx)(n.li,{children:"Use appropriate image resolutions"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"TF synchronization problems"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure consistent frame naming"}),"\n",(0,i.jsx)(n.li,{children:"Check TF tree validity"}),"\n",(0,i.jsx)(n.li,{children:"Verify timestamp synchronization"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Perception package errors"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure Perception package is properly installed"}),"\n",(0,i.jsx)(n.li,{children:"Check for required dependencies"}),"\n",(0,i.jsx)(n.li,{children:"Verify camera configurations"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"assessment-questions",children:"Assessment Questions"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"What are the key differences between Unity's and ROS's coordinate systems?"}),"\n",(0,i.jsx)(n.li,{children:"How do you establish communication between Unity and ROS?"}),"\n",(0,i.jsx)(n.li,{children:"What is the purpose of the Perception package in Unity?"}),"\n",(0,i.jsx)(n.li,{children:"How would you synchronize robot states between Unity and Gazebo?"}),"\n",(0,i.jsx)(n.li,{children:"What are the advantages of using Unity for robotics simulation?"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"extension-exercises",children:"Extension Exercises"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a complete humanoid robot model in Unity with all joints"}),"\n",(0,i.jsx)(n.li,{children:"Implement a navigation system that works with both Unity and ROS"}),"\n",(0,i.jsx)(n.li,{children:"Add realistic physics to the Unity simulation"}),"\n",(0,i.jsx)(n.li,{children:"Create a user interface for controlling the Unity robot"}),"\n",(0,i.jsx)(n.li,{children:"Implement machine learning training using Unity's synthetic data"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(n.p,{children:"In this lab, you successfully:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Installed and configured Unity Robotics Hub"}),"\n",(0,i.jsx)(n.li,{children:"Set up ROS-TCP-Connector for Unity-ROS communication"}),"\n",(0,i.jsx)(n.li,{children:"Created robot models and scenes in Unity for robotics"}),"\n",(0,i.jsx)(n.li,{children:"Implemented perception systems using Unity's Perception package"}),"\n",(0,i.jsx)(n.li,{children:"Established bidirectional communication between Unity and ROS"}),"\n",(0,i.jsx)(n.li,{children:"Created synthetic data generation pipelines"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"These skills enable you to create sophisticated digital twin environments that complement your Gazebo simulations, providing a more immersive visualization and perception development platform. The Unity-ROS integration opens up possibilities for advanced human-robot interaction, realistic sensor simulation, and synthetic data generation for AI training."})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var i=t(6540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);