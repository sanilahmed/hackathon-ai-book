"use strict";(globalThis.webpackChunkphysical_ai_book=globalThis.webpackChunkphysical_ai_book||[]).push([[8751],{7306:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var t=i(4848),s=i(8453);const r={},o="Lab 1.1: ROS 2 Fundamentals for Humanoid Robotics",a={id:"modules/lab-exercises/lab-1-1-ros2-basics",title:"Lab 1.1: ROS 2 Fundamentals for Humanoid Robotics",description:"Overview",source:"@site/docs/modules/lab-exercises/lab-1-1-ros2-basics.md",sourceDirName:"modules/lab-exercises",slug:"/modules/lab-exercises/lab-1-1-ros2-basics",permalink:"/ai-robotic-book/modules/lab-exercises/lab-1-1-ros2-basics",draft:!1,unlisted:!1,editUrl:"https://github.com/your-org/physical-ai-book/tree/main/docs/modules/lab-exercises/lab-1-1-ros2-basics.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"AI Integration with ROS 2",permalink:"/ai-robotic-book/modules/ros2-nervous-system/ai-integration"},next:{title:"Lab 1.1: ROS 2 Environment Setup and Basic Nodes",permalink:"/ai-robotic-book/modules/lab-exercises/lab-1-1-ros2-setup"}},l={},c=[{value:"Overview",id:"overview",level:2},{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Theory Background",id:"theory-background",level:2},{value:"Lab Exercise",id:"lab-exercise",level:2},{value:"Part 1: Creating Your First ROS 2 Node",id:"part-1-creating-your-first-ros-2-node",level:3},{value:"Part 2: Creating a Joint State Subscriber",id:"part-2-creating-a-joint-state-subscriber",level:3},{value:"Part 3: Creating a ROS 2 Service",id:"part-3-creating-a-ros-2-service",level:3},{value:"Part 4: Creating a ROS 2 Action Server",id:"part-4-creating-a-ros-2-action-server",level:3},{value:"Part 5: Creating a Parameter Server",id:"part-5-creating-a-parameter-server",level:3},{value:"Part 6: Creating a Launch File",id:"part-6-creating-a-launch-file",level:3},{value:"Part 7: Creating a C++ Node Example",id:"part-7-creating-a-c-node-example",level:3},{value:"Implementation Steps",id:"implementation-steps",level:2},{value:"Expected Outcomes",id:"expected-outcomes",level:2},{value:"Troubleshooting Tips",id:"troubleshooting-tips",level:2},{value:"Further Exploration",id:"further-exploration",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"lab-11-ros-2-fundamentals-for-humanoid-robotics",children:"Lab 1.1: ROS 2 Fundamentals for Humanoid Robotics"}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"This lab exercise introduces the fundamental concepts of ROS 2 (Robot Operating System 2) specifically applied to humanoid robotics. Students will learn to create nodes, topics, services, and actions while understanding how they apply to controlling humanoid robots with multiple degrees of freedom."}),"\n",(0,t.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,t.jsx)(n.p,{children:"By the end of this lab, students will be able to:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Create and run basic ROS 2 nodes in Python and C++"}),"\n",(0,t.jsx)(n.li,{children:"Implement publisher-subscriber communication patterns"}),"\n",(0,t.jsx)(n.li,{children:"Use services for request-response communication"}),"\n",(0,t.jsx)(n.li,{children:"Work with actions for goal-oriented communication"}),"\n",(0,t.jsx)(n.li,{children:"Understand ROS 2 workspace structure and package management"}),"\n",(0,t.jsx)(n.li,{children:"Apply ROS 2 concepts to humanoid robot control"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Basic knowledge of Python or C++"}),"\n",(0,t.jsx)(n.li,{children:"Understanding of Linux command line"}),"\n",(0,t.jsx)(n.li,{children:"Familiarity with version control systems (Git)"}),"\n",(0,t.jsx)(n.li,{children:"ROS 2 Humble Hawksbill installed on Ubuntu 22.04"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"theory-background",children:"Theory Background"}),"\n",(0,t.jsx)(n.p,{children:"ROS 2 is a middleware framework that provides services designed for robot applications, including hardware abstraction, device drivers, libraries, visualizers, message-passing, package management, and more. Key concepts include:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Nodes"}),": Processes that perform computation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Topics"}),": Named buses over which nodes exchange messages"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Publishers/Subscribers"}),": Communication pattern for one-to-many message passing"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Services"}),": Request-response communication pattern"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Actions"}),": Goal-oriented communication with feedback"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Packages"}),": Organizational unit containing code and resources"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"lab-exercise",children:"Lab Exercise"}),"\n",(0,t.jsx)(n.h3,{id:"part-1-creating-your-first-ros-2-node",children:"Part 1: Creating Your First ROS 2 Node"}),"\n",(0,t.jsx)(n.p,{children:"Let's start by creating a simple ROS 2 node that publishes humanoid joint states:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import JointState\nfrom std_msgs.msg import Header\nimport math\nimport time\n\nclass HumanoidJointPublisher(Node):\n    def __init__(self):\n        super().__init__('humanoid_joint_publisher')\n\n        # Create publisher for joint states\n        self.publisher_ = self.create_publisher(JointState, 'joint_states', 10)\n\n        # Create timer to publish at 50 Hz\n        self.timer = self.create_timer(0.02, self.publish_joint_states)\n\n        # Initialize joint names for a 14-DOF humanoid\n        self.joint_names = [\n            'torso_joint',\n            'head_joint',\n            'left_shoulder_joint', 'left_elbow_joint', 'left_wrist_joint',\n            'right_shoulder_joint', 'right_elbow_joint', 'right_wrist_joint',\n            'left_hip_joint', 'left_knee_joint', 'left_ankle_joint',\n            'right_hip_joint', 'right_knee_joint', 'right_ankle_joint'\n        ]\n\n        # Initialize joint positions (starting pose)\n        self.joint_positions = [0.0] * len(self.joint_names)\n\n        # Initialize time for trajectory generation\n        self.start_time = time.time()\n\n        self.get_logger().info('Humanoid Joint Publisher node initialized')\n\n    def publish_joint_states(self):\n        \"\"\"Publish joint state messages\"\"\"\n        msg = JointState()\n        msg.header = Header()\n        msg.header.stamp = self.get_clock().now().to_msg()\n        msg.header.frame_id = 'base_link'\n\n        msg.name = self.joint_names\n\n        # Generate a simple oscillating motion for demonstration\n        current_time = time.time() - self.start_time\n        amplitude = 0.2\n        frequency = 0.5  # Hz\n\n        # Apply oscillating motion to some joints\n        for i in range(len(self.joint_positions)):\n            # Apply different oscillation patterns to different joints\n            if i < 3:  # Torso and head\n                self.joint_positions[i] = amplitude * math.sin(2 * math.pi * frequency * current_time + i)\n            elif i < 6:  # Left arm\n                self.joint_positions[i] = amplitude * math.sin(2 * math.pi * frequency * current_time + i + 1)\n            elif i < 9:  # Right arm\n                self.joint_positions[i] = amplitude * math.sin(2 * math.pi * frequency * current_time + i + 2)\n            else:  # Legs\n                self.joint_positions[i] = amplitude * math.sin(2 * math.pi * frequency * current_time + i + 3)\n\n        msg.position = self.joint_positions\n        msg.velocity = [0.0] * len(self.joint_positions)  # Zero velocity for now\n        msg.effort = [0.0] * len(self.joint_positions)    # Zero effort for now\n\n        self.publisher_.publish(msg)\n        self.get_logger().debug(f'Published joint states: {self.joint_positions[:3]}...')\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    joint_publisher = HumanoidJointPublisher()\n\n    try:\n        rclpy.spin(joint_publisher)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        joint_publisher.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,t.jsx)(n.h3,{id:"part-2-creating-a-joint-state-subscriber",children:"Part 2: Creating a Joint State Subscriber"}),"\n",(0,t.jsx)(n.p,{children:"Now let's create a subscriber that listens to joint states and processes them:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import JointState\nfrom std_msgs.msg import String\nimport numpy as np\n\nclass HumanoidJointSubscriber(Node):\n    def __init__(self):\n        super().__init__('humanoid_joint_subscriber')\n\n        # Create subscriber for joint states\n        self.subscription = self.create_subscription(\n            JointState,\n            'joint_states',\n            self.joint_state_callback,\n            10)\n\n        # Create publisher for processed data\n        self.status_publisher = self.create_publisher(String, 'robot_status', 10)\n\n        # Store the latest joint state\n        self.latest_joint_state = None\n\n        self.get_logger().info('Humanoid Joint Subscriber node initialized')\n\n    def joint_state_callback(self, msg):\n        \"\"\"Process incoming joint state messages\"\"\"\n        self.latest_joint_state = msg\n\n        # Calculate some basic metrics\n        avg_position = np.mean(msg.position) if msg.position else 0.0\n        max_position = max(msg.position) if msg.position else 0.0\n        min_position = min(msg.position) if msg.position else 0.0\n\n        # Check for joint limits (simplified)\n        joint_limits_exceeded = any(abs(pos) > 2.0 for pos in msg.position)  # 2.0 rad limit\n\n        # Create status message\n        status_msg = String()\n        status_msg.data = (\n            f'Robot Status - Avg Pos: {avg_position:.3f}, '\n            f'Max Pos: {max_position:.3f}, '\n            f'Min Pos: {min_position:.3f}, '\n            f'Joints: {len(msg.position)}, '\n            f'Limit Exceeded: {joint_limits_exceeded}'\n        )\n\n        self.status_publisher.publish(status_msg)\n\n        # Log if any joint limits are exceeded\n        if joint_limits_exceeded:\n            self.get_logger().warn('Joint limit exceeded - check robot configuration!')\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    joint_subscriber = HumanoidJointSubscriber()\n\n    try:\n        rclpy.spin(joint_subscriber)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        joint_subscriber.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,t.jsx)(n.h3,{id:"part-3-creating-a-ros-2-service",children:"Part 3: Creating a ROS 2 Service"}),"\n",(0,t.jsx)(n.p,{children:"Let's implement a service that allows remote control of the humanoid robot:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import Float32MultiArray\nfrom example_interfaces.srv import SetBool\nimport numpy as np\n\nclass HumanoidControlService(Node):\n    def __init__(self):\n        super().__init__('humanoid_control_service')\n\n        # Create service\n        self.srv = self.create_service(\n            SetBool,\n            'set_robot_mode',\n            self.set_robot_mode_callback\n        )\n\n        # Create publisher for joint commands\n        self.joint_command_publisher = self.create_publisher(\n            Float32MultiArray,\n            'joint_commands',\n            10\n        )\n\n        # Robot state\n        self.robot_enabled = False\n        self.current_pose = [0.0] * 14  # 14 DOF humanoid\n\n        self.get_logger().info('Humanoid Control Service initialized')\n\n    def set_robot_mode_callback(self, request, response):\n        \"\"\"Handle robot mode change requests\"\"\"\n        if request.data:\n            self.robot_enabled = True\n            response.success = True\n            response.message = 'Robot enabled successfully'\n            self.get_logger().info('Robot enabled')\n        else:\n            self.robot_enabled = False\n            response.success = True\n            response.message = 'Robot disabled successfully'\n            self.get_logger().info('Robot disabled')\n\n        return response\n\n    def send_joint_command(self, joint_positions):\n        \"\"\"Send joint position commands\"\"\"\n        if not self.robot_enabled:\n            self.get_logger().warn('Robot not enabled, cannot send commands')\n            return False\n\n        if len(joint_positions) != 14:\n            self.get_logger().error(f'Expected 14 joint positions, got {len(joint_positions)}')\n            return False\n\n        # Publish joint commands\n        cmd_msg = Float32MultiArray()\n        cmd_msg.data = joint_positions\n        self.joint_command_publisher.publish(cmd_msg)\n\n        self.current_pose = joint_positions\n        return True\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    control_service = HumanoidControlService()\n\n    try:\n        rclpy.spin(control_service)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        control_service.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,t.jsx)(n.h3,{id:"part-4-creating-a-ros-2-action-server",children:"Part 4: Creating a ROS 2 Action Server"}),"\n",(0,t.jsx)(n.p,{children:"Now let's implement an action server for complex humanoid behaviors:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.action import ActionServer, CancelResponse, GoalResponse\nfrom rclpy.node import Node\nfrom rclpy.callback_groups import ReentrantCallbackGroup\nfrom rclpy.executors import MultiThreadedExecutor\nimport time\nfrom example_interfaces.action import Fibonacci\n\nclass HumanoidActionServer(Node):\n    def __init__(self):\n        super().__init__('humanoid_action_server')\n\n        # Create action server with reentrant callback group\n        self._action_server = ActionServer(\n            self,\n            Fibonacci,\n            'move_humanoid',\n            execute_callback=self.execute_callback,\n            callback_group=ReentrantCallbackGroup(),\n            goal_callback=self.goal_callback,\n            cancel_callback=self.cancel_callback\n        )\n\n        self.get_logger().info('Humanoid Action Server initialized')\n\n    def goal_callback(self, goal_request):\n        \"\"\"Accept or reject goal requests\"\"\"\n        self.get_logger().info(f'Received goal request with order: {goal_request.order}')\n        return GoalResponse.ACCEPT\n\n    def cancel_callback(self, goal_handle):\n        \"\"\"Accept or reject cancel requests\"\"\"\n        self.get_logger().info('Received cancel request')\n        return CancelResponse.ACCEPT\n\n    async def execute_callback(self, goal_handle):\n        \"\"\"Execute the action goal\"\"\"\n        self.get_logger().info('Executing goal...')\n\n        # Feedback and result\n        feedback_msg = Fibonacci.Feedback()\n        feedback_msg.sequence = [0, 1]\n\n        result = Fibonacci.Result()\n\n        # Simulate humanoid movement steps\n        for i in range(1, goal_handle.request.order):\n            if goal_handle.is_cancel_requested:\n                goal_handle.canceled()\n                self.get_logger().info('Goal canceled')\n                result.sequence = feedback_msg.sequence\n                return result\n\n            # Update feedback\n            feedback_msg.sequence.append(\n                feedback_msg.sequence[i] + feedback_msg.sequence[i-1]\n            )\n\n            # Publish feedback\n            goal_handle.publish_feedback(feedback_msg)\n            self.get_logger().info(f'Feedback: {feedback_msg.sequence[-1]}')\n\n            # Simulate movement time\n            time.sleep(0.5)\n\n        # Check if goal was canceled\n        if goal_handle.is_cancel_requested:\n            goal_handle.canceled()\n            self.get_logger().info('Goal canceled during execution')\n            result.sequence = feedback_msg.sequence\n            return result\n\n        # Complete the goal\n        goal_handle.succeed()\n        result.sequence = feedback_msg.sequence\n\n        self.get_logger().info(f'Result: {result.sequence}')\n        return result\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    action_server = HumanoidActionServer()\n\n    # Use MultiThreadedExecutor to handle callbacks in separate threads\n    executor = MultiThreadedExecutor()\n    executor.add_node(action_server)\n\n    try:\n        executor.spin()\n    except KeyboardInterrupt:\n        pass\n    finally:\n        action_server.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,t.jsx)(n.h3,{id:"part-5-creating-a-parameter-server",children:"Part 5: Creating a Parameter Server"}),"\n",(0,t.jsx)(n.p,{children:"Let's implement parameter management for humanoid robot configuration:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\nfrom rclpy.parameter import Parameter\nfrom rclpy.qos import qos_profile_system_default\nimport json\n\nclass HumanoidParameterServer(Node):\n    def __init__(self):\n        super().__init__('humanoid_parameter_server')\n\n        # Declare parameters with default values\n        self.declare_parameter('robot_name', 'humanoid_robot')\n        self.declare_parameter('max_velocity', 1.0)\n        self.declare_parameter('max_acceleration', 2.0)\n        self.declare_parameter('joint_limits', [2.0] * 14)  # 14 DOF\n        self.declare_parameter('control_mode', 'position')\n        self.declare_parameter('safety_enabled', True)\n\n        # Set up parameter change callback\n        self.add_on_set_parameters_callback(self.parameter_callback)\n\n        # Timer to periodically check parameters\n        self.timer = self.create_timer(1.0, self.check_parameters)\n\n        self.get_logger().info('Humanoid Parameter Server initialized')\n\n    def parameter_callback(self, params):\n        \"\"\"Handle parameter changes\"\"\"\n        for param in params:\n            if param.name == 'max_velocity':\n                if param.value > 5.0:\n                    self.get_logger().warn(f'Max velocity {param.value} may be unsafe')\n            elif param.name == 'joint_limits':\n                if len(param.value) != 14:\n                    return rclpy.node.SetParametersResult(\n                        successful=False,\n                        reason='Joint limits must have 14 values for 14-DOF robot'\n                    )\n\n        return rclpy.node.SetParametersResult(successful=True)\n\n    def check_parameters(self):\n        \"\"\"Periodically check and log parameter values\"\"\"\n        robot_name = self.get_parameter('robot_name').value\n        max_vel = self.get_parameter('max_velocity').value\n        safety_enabled = self.get_parameter('safety_enabled').value\n\n        self.get_logger().info(\n            f'Robot: {robot_name}, Max Vel: {max_vel}, Safety: {safety_enabled}'\n        )\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    param_server = HumanoidParameterServer()\n\n    try:\n        rclpy.spin(param_server)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        param_server.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,t.jsx)(n.h3,{id:"part-6-creating-a-launch-file",children:"Part 6: Creating a Launch File"}),"\n",(0,t.jsx)(n.p,{children:"Let's create a launch file to bring up the complete humanoid system:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n\nfrom launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument, RegisterEventHandler\nfrom launch.event_handlers import OnProcessStart\nfrom launch.substitutions import LaunchConfiguration\nfrom launch_ros.actions import Node\nfrom launch.conditions import IfCondition\nfrom ament_index_python.packages import get_package_share_directory\nimport os\n\ndef generate_launch_description():\n    # Declare launch arguments\n    use_sim_time = LaunchConfiguration('use_sim_time', default='false')\n    robot_name = LaunchConfiguration('robot_name', default='humanoid_robot')\n\n    # Get package directory\n    pkg_name = 'humanoid_control'\n\n    # Joint state publisher node\n    joint_publisher_node = Node(\n        package='humanoid_control',\n        executable='humanoid_joint_publisher',\n        name='humanoid_joint_publisher',\n        parameters=[\n            {'use_sim_time': use_sim_time},\n            {'robot_name': robot_name}\n        ],\n        output='screen'\n    )\n\n    # Joint state subscriber node\n    joint_subscriber_node = Node(\n        package='humanoid_control',\n        executable='humanoid_joint_subscriber',\n        name='humanoid_joint_subscriber',\n        parameters=[\n            {'use_sim_time': use_sim_time}\n        ],\n        output='screen'\n    )\n\n    # Control service node\n    control_service_node = Node(\n        package='humanoid_control',\n        executable='humanoid_control_service',\n        name='humanoid_control_service',\n        parameters=[\n            {'use_sim_time': use_sim_time}\n        ],\n        output='screen'\n    )\n\n    # Action server node\n    action_server_node = Node(\n        package='humanoid_control',\n        executable='humanoid_action_server',\n        name='humanoid_action_server',\n        parameters=[\n            {'use_sim_time': use_sim_time}\n        ],\n        output='screen'\n    )\n\n    # Parameter server node\n    param_server_node = Node(\n        package='humanoid_control',\n        executable='humanoid_parameter_server',\n        name='humanoid_parameter_server',\n        parameters=[\n            {'use_sim_time': use_sim_time}\n        ],\n        output='screen'\n    )\n\n    # RViz2 node for visualization\n    rviz_config = os.path.join(\n        get_package_share_directory(pkg_name),\n        'config',\n        'humanoid_rviz_config.rviz'\n    )\n\n    rviz_node = Node(\n        package='rviz2',\n        executable='rviz2',\n        name='rviz2',\n        arguments=['-d', rviz_config],\n        parameters=[\n            {'use_sim_time': use_sim_time}\n        ],\n        output='screen'\n    )\n\n    return LaunchDescription([\n        DeclareLaunchArgument(\n            'use_sim_time',\n            default_value='false',\n            description='Use simulation (Gazebo) clock if true'\n        ),\n        DeclareLaunchArgument(\n            'robot_name',\n            default_value='humanoid_robot',\n            description='Name of the robot'\n        ),\n        joint_publisher_node,\n        joint_subscriber_node,\n        control_service_node,\n        action_server_node,\n        param_server_node,\n        rviz_node\n    ])\n"})}),"\n",(0,t.jsx)(n.h3,{id:"part-7-creating-a-c-node-example",children:"Part 7: Creating a C++ Node Example"}),"\n",(0,t.jsx)(n.p,{children:"Finally, let's create a C++ node for performance-critical humanoid control:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'#include <rclcpp/rclcpp.hpp>\n#include <sensor_msgs/msg/joint_state.hpp>\n#include <std_msgs/msg/float64_multi_array.hpp>\n#include <vector>\n#include <string>\n#include <chrono>\n\nclass HumanoidController : public rclcpp::Node\n{\npublic:\n    HumanoidController() : Node("humanoid_controller_cpp")\n    {\n        // Create publisher for joint commands\n        joint_command_publisher_ = this->create_publisher<std_msgs::msg::Float64MultiArray>(\n            "joint_commands_cpp", 10);\n\n        // Create subscriber for joint states\n        joint_state_subscription_ = this->create_subscription<sensor_msgs::msg::JointState>(\n            "joint_states", 10,\n            std::bind(&HumanoidController::joint_state_callback, this, std::placeholders::_1));\n\n        // Create timer for control loop\n        control_timer_ = this->create_wall_timer(\n            std::chrono::milliseconds(20), // 50 Hz\n            std::bind(&HumanoidController::control_loop, this));\n\n        // Initialize joint names\n        joint_names_ = {\n            "torso_joint", "head_joint",\n            "left_shoulder_joint", "left_elbow_joint", "left_wrist_joint",\n            "right_shoulder_joint", "right_elbow_joint", "right_wrist_joint",\n            "left_hip_joint", "left_knee_joint", "left_ankle_joint",\n            "right_hip_joint", "right_knee_joint", "right_ankle_joint"\n        };\n\n        // Initialize target positions\n        target_positions_.resize(joint_names_.size(), 0.0);\n        current_positions_.resize(joint_names_.size(), 0.0);\n\n        RCLCPP_INFO(this->get_logger(), "Humanoid Controller C++ node initialized");\n    }\n\nprivate:\n    void joint_state_callback(const sensor_msgs::msg::JointState::SharedPtr msg)\n    {\n        // Update current joint positions\n        if (msg->position.size() == current_positions_.size()) {\n            current_positions_ = msg->position;\n        }\n    }\n\n    void control_loop()\n    {\n        // Simple PD controller for each joint\n        std::vector<double> commands;\n\n        for (size_t i = 0; i < target_positions_.size(); ++i) {\n            double error = target_positions_[i] - current_positions_[i];\n            double command = 10.0 * error; // Simple proportional control\n\n            // Apply limits\n            if (command > 2.0) command = 2.0;\n            if (command < -2.0) command = -2.0;\n\n            commands.push_back(command);\n        }\n\n        // Publish commands\n        auto cmd_msg = std_msgs::msg::Float64MultiArray();\n        cmd_msg.data = commands;\n        joint_command_publisher_->publish(cmd_msg);\n\n        // Update targets with a simple oscillating pattern\n        static double time_counter = 0.0;\n        time_counter += 0.02; // 50 Hz * 0.02s = 1 step per second\n\n        for (size_t i = 0; i < target_positions_.size(); ++i) {\n            target_positions_[i] = 0.5 * sin(time_counter + i * 0.1);\n        }\n    }\n\n    rclcpp::Publisher<std_msgs::msg::Float64MultiArray>::SharedPtr joint_command_publisher_;\n    rclcpp::Subscription<sensor_msgs::msg::JointState>::SharedPtr joint_state_subscription_;\n    rclcpp::TimerBase::SharedPtr control_timer_;\n\n    std::vector<std::string> joint_names_;\n    std::vector<double> target_positions_;\n    std::vector<double> current_positions_;\n};\n\nint main(int argc, char * argv[])\n{\n    rclcpp::init(argc, argv);\n    rclcpp::spin(std::make_shared<HumanoidController>());\n    rclcpp::shutdown();\n    return 0;\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"implementation-steps",children:"Implementation Steps"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Create a new ROS 2 package for humanoid control:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws/src\nros2 pkg create --build-type ament_python humanoid_control\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Create the Python nodes in the package:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"humanoid_joint_publisher.py"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"humanoid_joint_subscriber.py"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"humanoid_control_service.py"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"humanoid_action_server.py"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"humanoid_parameter_server.py"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Create the launch file in ",(0,t.jsx)(n.code,{children:"launch/humanoid_system_launch.py"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Create the C++ node and add it to ",(0,t.jsx)(n.code,{children:"CMakeLists.txt"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Build the package:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\ncolcon build --packages-select humanoid_control\nsource install/setup.bash\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Run the system:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ros2 launch humanoid_control humanoid_system_launch.py\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"expected-outcomes",children:"Expected Outcomes"}),"\n",(0,t.jsx)(n.p,{children:"After completing this lab, you should have:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"A working ROS 2 workspace with a humanoid control package"}),"\n",(0,t.jsx)(n.li,{children:"Multiple nodes implementing different communication patterns"}),"\n",(0,t.jsx)(n.li,{children:"A launch file that brings up the complete system"}),"\n",(0,t.jsx)(n.li,{children:"Understanding of ROS 2 concepts applied to humanoid robotics"}),"\n",(0,t.jsx)(n.li,{children:"Experience with both Python and C++ ROS 2 development"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting-tips",children:"Troubleshooting Tips"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Ensure ROS 2 environment is sourced before running nodes"}),"\n",(0,t.jsx)(n.li,{children:"Check that all dependencies are properly installed"}),"\n",(0,t.jsx)(n.li,{children:"Verify topic names match between publishers and subscribers"}),"\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.code,{children:"ros2 topic list"})," and ",(0,t.jsx)(n.code,{children:"ros2 node list"})," to verify system status"]}),"\n",(0,t.jsx)(n.li,{children:"Monitor system performance and adjust timer rates as needed"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"further-exploration",children:"Further Exploration"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Implement more complex humanoid behaviors using state machines"}),"\n",(0,t.jsx)(n.li,{children:"Add TF (Transforms) for robot kinematics"}),"\n",(0,t.jsx)(n.li,{children:"Create custom message types for humanoid-specific data"}),"\n",(0,t.jsx)(n.li,{children:"Integrate with Gazebo simulation for realistic testing"}),"\n",(0,t.jsx)(n.li,{children:"Implement safety systems and emergency stops"}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>a});var t=i(6540);const s={},r=t.createContext(s);function o(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);